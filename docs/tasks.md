# Semantic Git-CZ Rust Library 作業計画書

## プロジェクト概要

git-czのようなコミットメッセージ作成ツールに、セマンティックバージョニングの概念を組み込んだRustライブラリを開発します。**Rust標準ライブラリのみを使用して実装します。**

### 主な機能

- セマンティックバージョン（major/minor/patch）の選択
- コミットタイプ（feat/fix/docs等）の選択
- 絵文字付きコミットメッセージの作成
- フォーマット: `patch-feat: :emoji: example commit message`

## プロジェクト構成

```
semantic-git-cz/
├── Cargo.toml              # プロジェクト設定（依存関係なし）
├── src/
│   ├── main.rs            # CLIエントリーポイント
│   ├── lib.rs             # ライブラリのエクスポート
│   ├── semver.rs          # セマンティックバージョン処理
│   ├── commit_types.rs    # コミットタイプ定義
│   ├── prompts.rs         # 対話的プロンプト
│   └── git.rs             # Git操作
├── docs/
│   └── tasks.md           # 本作業計画書
├── tests/
│   └── integration_test.rs # 統合テスト
└── README.md              # プロジェクト説明書
```

## 実装タスク

### フェーズ1: プロジェクトの初期設定

- [ ] Rustプロジェクトの作成 (`cargo new semantic-git-cz`)
- [ ] Cargo.tomlの設定（外部依存関係なし）
- [ ] 基本的なエラーハンドリング構造の実装（Result型の活用）

### フェーズ2: セマンティックバージョンモジュール (src/semver.rs)

- [ ] `SemverType` enumの定義

  ```rust
  enum SemverType {
      Major,  // 破壊的変更
      Minor,  // 機能追加
      Patch,  // バグ修正
  }
  ```

- [ ] 表示フォーマットの実装
- [ ] 対話的選択プロンプトの実装

### フェーズ3: コミットタイプモジュール (src/commit_types.rs)

- [ ] `CommitType` enumの定義と絵文字マッピング
  - feat (✨): 新機能
  - fix (🐛): バグ修正
  - docs (📚): ドキュメント
  - style (💎): コードスタイル
  - refactor (♻️): リファクタリング
  - test (🧪): テスト
  - chore (🔧): メンテナンス
  - ci (🚀): CI/CD
  - perf (⚡): パフォーマンス改善

### フェーズ4: 対話的プロンプト (src/prompts.rs)

- [ ] std::io::stdin/stdoutを使用した入力処理
- [ ] セマンティックバージョン選択メニュー（番号選択式）
- [ ] コミットタイプ選択メニュー（番号選択式）
- [ ] コミットメッセージ入力（検証付き）

### フェーズ5: コミットフォーマット

- [ ] メッセージフォーマッターの実装
  - 基本形式: `{semver}-{type}: {emoji} {message}`
  - 例: `patch-feat: ✨ ユーザー認証機能を追加`

### フェーズ6: Git統合 (src/git.rs)

- [ ] std::process::Commandを使用したgitコマンドの実行
- [ ] 現在のディレクトリがGitリポジトリかチェック（`git rev-parse`）
- [ ] フォーマット済みメッセージでコミット作成（`git commit`）
- [ ] Gitエラーの適切なハンドリング
- [ ] ステージングされた変更の確認（`git status`）

### フェーズ7: CLI実装 (src/main.rs)

- [ ] std::env::argsを使用したコマンドライン引数の解析
- [ ] 手動の引数パーサー実装
- [ ] 基本コマンド：`semantic-git-cz`（通常の対話的コミット）
- [ ] ヘルプメッセージとバージョン情報

### フェーズ8: テストとドキュメント

- [ ] 単体テスト
  - 各モジュールのユニットテスト
  - エッジケースのテスト
- [ ] 統合テスト
  - 完全なワークフローのテスト
- [ ] ドキュメント
  - README.mdの作成（使用例付き）
  - APIドキュメント（cargo doc）

## マイルストーン

### マイルストーン1: MVP（最小限の実装）

- 基本的なセマンティックバージョン選択
- 主要なコミットタイプ
- シンプルなコミットメッセージ作成

### マイルストーン2: 完全な機能実装

- すべてのコミットタイプ
- エラーハンドリング

### マイルストーン3: プロダクション準備

- 包括的なテスト
- ドキュメント完成
- パフォーマンス最適化

## 技術的な考慮事項

### エラーハンドリング

- Result<T, E>型を使用した一貫性のあるエラー処理
- カスタムエラー型の定義
- ユーザーフレンドリーなエラーメッセージ
- Gitエラーの適切な変換

### パフォーマンス

- 高速な起動時間
- 外部依存関係なし（標準ライブラリのみ）
- 効率的な設定ファイル読み込み

### 互換性

- Windows、macOS、Linuxでの動作確認
- Git 2.0以上のサポート
- Rust 1.70以上でのビルド

## 開発スケジュール（目安）

| フェーズ | 期間 | 内容 |
|---------|------|------|
| 1-3 | 1週目 | 基本構造とコアモジュール |
| 4-6 | 2週目 | 対話的機能とGit統合 |
| 7 | 3週目 | CLI実装 |
| 8 | 4週目 | テストとドキュメント |

## 成功指標

- 直感的なユーザーインターフェース
- 高速な実行速度（< 100ms）
- 包括的なテストカバレッジ（> 90%）
- 明確なドキュメント
- エラーのない安定した動作
- 外部依存関係ゼロ（標準ライブラリのみ使用）

## 実装における制約と工夫

### 標準ライブラリのみでの実装方法

1. **CLI引数解析**: std::env::argsとパターンマッチング
2. **対話的入力**: std::io::stdin/stdout
3. **Git操作**: std::process::Commandでgitコマンドを実行
4. **カラー出力**: ANSIエスケープシーケンスの直接使用
5. **エラー処理**: Result型とカスタムエラー型の活用

